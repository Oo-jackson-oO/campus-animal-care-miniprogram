# æ•°æ®åº“è„šæœ¬æ‰§è¡ŒæŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é¦–æ¬¡æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–
```bash
# æ–¹æ³•1: ä½¿ç”¨PowerShell
cmd /c "mysql -u root -p < database/init.sql"

# æ–¹æ³•2: ä½¿ç”¨MySQLå‘½ä»¤è¡Œ
mysql -u root -p -e "source database/init.sql"

# æ–¹æ³•3: åˆ†æ­¥æ‰§è¡Œ
mysql -u root -p
source database/init.sql;
```

### 2. æ’å…¥ç¤ºä¾‹æ•°æ®
```bash
cmd /c "mysql -u root -p < database/sample_data.sql"
```

### 3. éªŒè¯æ•°æ®åº“åˆ›å»º
```bash
cmd /c "mysql -u root -p < database/test_multiple_execution.sql"
```

## âœ… å®‰å…¨ç‰¹æ€§

### å¤šæ¬¡æ‰§è¡Œä¿æŠ¤
- âœ… **æ•°æ®åº“**: `CREATE DATABASE IF NOT EXISTS`
- âœ… **è¡¨**: `CREATE TABLE IF NOT EXISTS`
- âœ… **è§†å›¾**: `CREATE OR REPLACE VIEW`
- âœ… **å­˜å‚¨è¿‡ç¨‹**: `DROP PROCEDURE IF EXISTS` + `CREATE PROCEDURE`
- âœ… **è§¦å‘å™¨**: `DROP TRIGGER IF EXISTS` + `CREATE TRIGGER`
- âœ… **æ•°æ®æ’å…¥**: `INSERT IGNORE`

### å…¼å®¹æ€§è®¾ç½®
- è®¾ç½®SQLæ¨¡å¼ç¡®ä¿å…¼å®¹æ€§
- ä½¿ç”¨UTF8MB4å­—ç¬¦é›†æ”¯æŒemoji
- è‡ªåŠ¨å¤„ç†æ—¶åŒºé—®é¢˜

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æƒé™é—®é¢˜
```sql
-- æ£€æŸ¥ç”¨æˆ·æƒé™
SHOW GRANTS FOR 'root'@'localhost';

-- å¦‚æœéœ€è¦ï¼Œåˆ›å»ºä¸“ç”¨ç”¨æˆ·
CREATE USER 'campus_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON campus_animal_care.* TO 'campus_user'@'localhost';
FLUSH PRIVILEGES;
```

#### 2. å­—ç¬¦é›†é—®é¢˜
```sql
-- æ£€æŸ¥æ•°æ®åº“å­—ç¬¦é›†
SELECT DEFAULT_CHARACTER_SET_NAME, DEFAULT_COLLATION_NAME 
FROM information_schema.SCHEMATA 
WHERE SCHEMA_NAME = 'campus_animal_care';

-- æ£€æŸ¥è¡¨å­—ç¬¦é›†
SELECT TABLE_NAME, TABLE_COLLATION 
FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'campus_animal_care';
```

#### 3. å¤–é”®çº¦æŸé—®é¢˜
```sql
-- ä¸´æ—¶ç¦ç”¨å¤–é”®æ£€æŸ¥
SET FOREIGN_KEY_CHECKS = 0;

-- æ‰§è¡Œè„šæœ¬
source database/init.sql;

-- é‡æ–°å¯ç”¨å¤–é”®æ£€æŸ¥
SET FOREIGN_KEY_CHECKS = 1;
```

## ğŸ“Š éªŒè¯è„šæœ¬

### æ£€æŸ¥æ•°æ®åº“ç»“æ„
```sql
USE campus_animal_care;

-- æŸ¥çœ‹æ‰€æœ‰è¡¨
SHOW TABLES;

-- æŸ¥çœ‹è¡¨ç»“æ„
DESCRIBE users;
DESCRIBE animals;
DESCRIBE products;

-- æŸ¥çœ‹è§†å›¾
SHOW FULL TABLES WHERE Table_type = 'VIEW';

-- æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹
SHOW PROCEDURE STATUS WHERE Db = 'campus_animal_care';

-- æŸ¥çœ‹è§¦å‘å™¨
SHOW TRIGGERS FROM campus_animal_care;
```

### æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
```sql
-- æ£€æŸ¥å¤–é”®çº¦æŸ
SELECT 
    TABLE_NAME,
    COLUMN_NAME,
    CONSTRAINT_NAME,
    REFERENCED_TABLE_NAME,
    REFERENCED_COLUMN_NAME
FROM information_schema.KEY_COLUMN_USAGE
WHERE TABLE_SCHEMA = 'campus_animal_care'
AND REFERENCED_TABLE_NAME IS NOT NULL;

-- æ£€æŸ¥ç´¢å¼•
SELECT 
    TABLE_NAME,
    INDEX_NAME,
    COLUMN_NAME
FROM information_schema.STATISTICS
WHERE TABLE_SCHEMA = 'campus_animal_care'
ORDER BY TABLE_NAME, INDEX_NAME;
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å¤‡ä»½ç­–ç•¥
```bash
# å¤‡ä»½æ•°æ®åº“
mysqldump -u root -p campus_animal_care > backup_$(date +%Y%m%d_%H%M%S).sql

# æ¢å¤æ•°æ®åº“
mysql -u root -p campus_animal_care < backup_file.sql
```

### 2. æ€§èƒ½ä¼˜åŒ–
```sql
-- åˆ†æè¡¨ç»Ÿè®¡ä¿¡æ¯
ANALYZE TABLE users, animals, products, donations;

-- ä¼˜åŒ–è¡¨
OPTIMIZE TABLE users, animals, products, donations;
```

### 3. ç›‘æ§å’Œç»´æŠ¤
```sql
-- æŸ¥çœ‹è¡¨å¤§å°
SELECT 
    TABLE_NAME,
    ROUND(((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024), 2) AS 'Size (MB)'
FROM information_schema.TABLES
WHERE TABLE_SCHEMA = 'campus_animal_care'
ORDER BY (DATA_LENGTH + INDEX_LENGTH) DESC;

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SHOW VARIABLES LIKE 'slow_query_log';
SHOW VARIABLES LIKE 'long_query_time';
```

## ğŸ”„ æ›´æ–°è„šæœ¬

å¦‚æœéœ€è¦æ›´æ–°æ•°æ®åº“ç»“æ„ï¼Œå»ºè®®ï¼š

1. **åˆ›å»ºè¿ç§»è„šæœ¬**è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹init.sql
2. **å¤‡ä»½ç°æœ‰æ•°æ®**åå†æ‰§è¡Œæ›´æ–°
3. **æµ‹è¯•è¿ç§»è„šæœ¬**åœ¨å¼€å‘ç¯å¢ƒ
4. **è®°å½•å˜æ›´æ—¥å¿—**ä¾¿äºè¿½è¸ª

### ç¤ºä¾‹è¿ç§»è„šæœ¬
```sql
-- migration_001_add_new_column.sql
USE campus_animal_care;

-- æ·»åŠ æ–°åˆ—
ALTER TABLE users ADD COLUMN last_login TIMESTAMP NULL AFTER updated_at;

-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_last_login ON users(last_login);

-- æ›´æ–°æ•°æ®
UPDATE users SET last_login = NOW() WHERE id = 1;
```

ç°åœ¨æ‚¨çš„æ•°æ®åº“è„šæœ¬å·²ç»å®Œå…¨æ”¯æŒå¤šæ¬¡å®‰å…¨æ‰§è¡Œäº†ï¼



